---
layout: post
title: JVM介绍
date: 2018-12-11 21:57:51
catalog: true
tags:
    - Java
    - JVM
---

`JDK 1.6`

## JVM是什么？

JVM是Java Virtual Machine的缩写，JVM是一种用于计算设备的规范，它是一个虚构出来的计算机，是通过在实际的计算机上仿真模拟各种计算机功能来实现的。

## JVM的位置

![img](../../../../img/in-post/post-java/jdk.jpg)

## JVM运行时数据区

![img](../../../../img/in-post/post-java/jvm.jpg)

#### 程序计数器

**指向当前线程正在执行的字节码指令的`地址`（行号）。** Java最小的执行单位是线程，这是由于CPU有时间片的概念，线程在一个时间片执行不完就会挂起，等待获取CPU资源后再次执行，这是就需要从程序计数器里获取当前线程执行的地址继续执行。

#### 虚拟机栈

**存储当前`线程`运行`方法`时所需要的数据、指令、返回地址。**
每个方法被执行的时候都会同时创建一个栈帧，用于存储`局部变量表`、`操作数栈`、`动态链接`、`方法出口`等信息。

- **局部变量表**：存放了编译期可知的各种基本数据类型（boolean、byte、char、short、int、float、long、double）、对象引用，32位的寻址空间。在编译期就确定大小。
- **操作数栈**：和局部变量区一样，操作数栈也是被组织成一个以字长为单位的数组。但是和前者不同的是，它不是通过索引来访问，而是通过标准的栈操作—压栈和出栈—来访问的。比如，如果某个指令把一个值压入到操作数栈中，稍后另一个指令就可以弹出这个值来使用。
- **动态链接**：每个栈帧都包含一个指向运行时常量池中该栈帧所属方法的引用，持有这个引用是为了支持方法调用过程中的动态连接。
- **方法出口**：方法退出的过程实际上等同于把当前栈帧出栈，因此退出时可能执行的操作有：恢复上层方法的局部变量表和操作数栈，如果有返回值，则把它压入调用者栈帧的操作数栈中，调整PC计数器的值以指向方法调用指令后面的一条指令。

> 反编译：javap -v ClassName.class >> className.txt，可以生成字节码文件

## 参考

[java中JVM的原理重温【转】](https://www.cnblogs.com/eastday/p/8124580.html)

[JVM简介](https://www.cnblogs.com/of-fanruice/p/7683308.html)